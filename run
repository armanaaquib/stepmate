#!/bin/bash

__frontend_standalone() {
  yarn --cwd=./frontend install && yarn --cwd=./frontend start
}

__frontend_test() {
  yarn --cwd=./frontend install && yarn --cwd=./frontend test
}

__backend_standalone() {
  ./gradlew clean bootRun
}

__backend_test() {
  ./gradlew cleanTest test
}

__local_install_git_hooks() {
  if ! type pre-commit >/dev/null; then
    echo "Downloading pre-commit..."
    brew install pre-commit
    echo "...Finish downloading"
  fi

  pre-commit install -f

  echo "Installed git hooks"
}

__service() {
  yarn --cwd=./frontend install && yarn --cwd=./frontend build

  cp -R ./frontend/build/* ./src/main/resources/static

  __backend_standalone
}

__build_docker_image() {
  docker build -t stepmate .
}

__run_container_in_local(){
  __build_docker_image
  docker run --publish 8000:8000 stepmate
}

CMD=${1:-}
__"$CMD"
